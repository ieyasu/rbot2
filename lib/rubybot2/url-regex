(?:(?:https?|ftp)://)?(?:(?#user)(?:[a-z0-9!*'(),$_.+-]|%[0-9a-f]{2})*(?:(?#password):(?:[a-z0-9!*'(),$_.+-]|%[0-9a-f]{2})*)@)?(?:(?#dotted quad)\d{1,3}(?:\.\d{1,3}){3}|(?#domain)(?:(?:[a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+(?#TLDs)(?:a(?:[cd]|e(?:ro|)|[fgilmnoqr]|s(?:ia|)|[tuwxz])|b(?:[abdefgh]|i(?:z|)|[jmnorstvwyz])|c(?:a(?:t|)|[cdfghiklmn]|o(?:m|op|)|[rsuvxyz])|d[ejkmoz]|e(?:c|du|[egrstu])|f[ijkmor]|g(?:[abdefghilmn]|ov|[pqrstuwy])|h[kmnrtu]|i(?:[delm]|n(?:fo|t|)|[oqrst])|j(?:[em]|o(?:bs|)|p)|k[eghimnprwyz]|l[abcikrstuvy]|m(?:[acdegh]|il|[klmn]|o(?:bi|)|[pqrst]|u(?:seum|)|[vwxyz])|n(?:a(?:me|)|c|e(?:t|)|[fgilopruz])|o(?:m|rg)|p(?:[aefghklmn]|r(?:o|)|[stwy])|qa|r[eosuw]|s[abcdeghijklmnortuvyz]|t(?:[cd]|el|[fghjklmnop]|r(?:avel|)|[tvwz])|u[agksyz]|v[aceginu]|w[fs]|xxx|y[et]|z[amw])(?![a-z]))(?:(?#port):\d{1,5})?(?:(?#path)/(?:[a-z0-9!*'(),$_.;:~@&=+-]|%[0-9a-f]{2})*(?:/(?:[a-z0-9!*'(),$_.;:~@&=+-]|%[0-9a-f]{2})*)*(?:(?#search)\?(?:[a-z0-9!*'(),$_.;:~@&=+-/]|%[0-9a-f]{2})*)?)?(?:(?#fragment)#(?:[a-z0-9!*'(),/?|$_.;:~@&=+-]|%[0-9a-f]{2})*)?
